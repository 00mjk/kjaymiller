<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="/static/css/tailwind.css">
    <script src="https://kit.fontawesome.com/4ac674b58e.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/base.css">
    <link rel="stylesheet" type="text/css" href="/static/css/pygments.css">
    
<link rel="stylesheet" type="text/css" href="/static/css/blog.css" />

    <title>
      
      Getting text from websites using Keyboard Maestro - Jay Miller
    </title>
  </head>
  <body class="flex flex-col h-full"> 
    <header class="bg-gradient-to-br from-blue-700 to-blue-500 w-full md:flex xl:py-10 py-3 px-3">
    <div class="mx-auto container">
    <h1 id="site-title" class="title mx-3 text-3xl font-bold text-gray-200">
      <a class="hover:no-decorate" href="/">Jay Miller</a>
    </h1>
  <div class="md:flex hidden" id="site-menu">
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/about.html">
                About
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/blog-0.html">
                Blog
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="https://www.youtube.com/channel/UCjoJU65IbXkKXsNqydro05Q">
                YouTube
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/productivity-0.html">
                Productivity
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/podcasts.html">
                Podcasts
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/projects.html">
                Projects
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/subscribe">
                Newsletter
                </a>
            </div>
            
            <div class="p-3">
                <a class="rounded p-2 hover:bg-gray-200 hover:text-gray-600 text-gray-200" href="/contact">
                Contact
                </a>
            </div>
            
  </div>
  <div class="hidden">
    <form role="search" action="https://search.kjaymiller.com/">
        <div class="md:flex hidden">
        <input type="text" style="padding-left: 3em; background: url('/static/files/search.svg') 7px 0px white no-repeat" class="inline border border-blue-800 rounded-full" name="q" id="search-bar" placeholder="Search"/>
        </div>
    </form>
</div>
    </div>
</header>
    <div class="sm:mx-2 xl:mx-auto xl:container flex-grow my-4">
        
<div class="container m-4">
  <article>
    <div class="m-3">
      <h1 class="title text-4xl font-bold">Getting text from websites using Keyboard Maestro</h1>
      <h2 class="text-xl">
        
      </h2>
      <small class="column is-narrow"> Mar 03, 2021 22:15 PM </small>
    </div>
    <section class="bg-gray-400 flex">
      <div class="">
         
        <p class="">
          <strong>Tags: </strong>
           <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="productivity-0"
    class="">productivity
   </a> 
</small >  <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="keyboard maestro-0"
    class="">keyboard maestro
   </a> 
</small >  <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="automation-0"
    class="">automation
   </a> 
</small > 
        </p>
        
      </div>
    </section>
    <hr />

       
<div class="my-6">
  <iframe
    class="xl:w-2/3 w-full"
    style="height: 32em"
    src="https://youtube.com/embed/U_VHfB9b9oE"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
  ></iframe>
  <h3 class="text-2xl">
    <a
      class="text-red-500"
      href="https://www.youtube.com/channel/UCjoJU65IbXkKXsNqydro05Q"
      >Check Out The YouTube Channel</a
    >
  </h3>
</div>

    <section class="section my-4 py-4">
      <div class="content"><p>In a <a href="https://kjaymiller.com/how-to-automate-form-filling-with-keyboard-maestro-for-big-sur">similar post</a> I showed how to input information into a browser using <a href="https://keyboardmaestro.com">Keyboard Maestro</a>. </p>

<p>In this post I want to show another integration with your browser and show you how you can get content from your browser to do whatever you want with.</p>

<p>This technique uses Javascript to return the text of an HTML element and then it can be manipulated using Keyboard Maestro.</p>

<h2>Enable Javascript from Apple Events</h2>

<p>This setting (off by default prevents rogue applications from taking control of your browser). In most cases this is a great security measure but in our case, it breaks the Keyboard Maestro functionality.</p>

<h3>For Safari</h3>

<p>With Safari open go to <strong>Preferences</strong> and select the advanced column.</p>

<p>Check the box <em>Show Develop menu in menu bar</em></p>

<p><img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/Keyboard%20Maestro%20Form%20Automation/Safari%20Show%20Develop%20Menu%20from%20MenuBar.png" alt="check the box show develop menu in menu bar" /></p>

<p>In the menu bar select the <em>Develop</em> menu and select the option <em>Allow Javascript from Apple Events</em>.</p>

<p><img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/Keyboard%20Maestro%20Form%20Automation/Safari%20Allow%20Javascript%20from%20Apple%20Events.png" alt="Enable Javascript from Apple Events" /></p>

<h3>For Chrome</h3>

<p>Chrome makes this a little easier. In the menu bar select <em>View</em>, then <em>Develop</em> (already visible) and select <em>Allow Javascript from Apple Events</em>.</p>

<p>In both cases, you will see a check mark that indicates you are ready to Automate!</p>

<h2>Navigate to the page you wish to get data from</h2>

<p>You can use Keyboard Maestro's <strong>New Safari/Chrome Tab with URL</strong>. If you do this make sure that you wait until the page is fully loaded or data may not be collectable. Luckily there is a <em>Wait for Safari/Chrome to Finish Loading</em> action you can use.</p>

<p><img src="https://ik.imagekit.io/cxazzw3yew/Keyboard%20Maestro%20Get%20Text%20from%20Website/New%20Tab%20with%20URL.png" alt="New Safari/Chrome Tab" /></p>

<h2>Find the element that you wish to get the text of</h2>

<p>Highlight the selected text on the page. Right Click and select <em>Inspect Element</em> (or <em>Inspect</em> for Chrome). This will open the developer console with that selected element highlighted.</p>

<p><img src="https://ik.imagekit.io/cxazzw3yew/Keyboard%20Maestro%20Get%20Text%20from%20Website/inspect%20element-squashed.png" alt="Inspect Element" />
Right click the element and hover over copy and choose the <em>Selector Path</em> (in Chrome choose <em>copy selector</em>)</p>

<p><img src="https://ik.imagekit.io/cxazzw3yew/Keyboard%20Maestro%20Get%20Text%20from%20Website/copy%20selector-squashed.png" alt="Copy Selector" /></p>

<h2>Use the <em>querySelector</em> method and <em>innerText</em> attribute</h2>

<p>Add the <strong>Execute Javascript in Safari/Chrome</strong> action and enter the following code.</p>

<div class="codehilite"><pre><span></span><code>document.querySelector(&quot;<span class="p">&lt;</span><span class="nt">PASTE</span> <span class="na">YOUR</span> <span class="na">COPIED</span> <span class="na">TEXT</span><span class="p">&gt;</span>&quot;).innerText`
</code></pre></div>

<p><code>document.querySelector</code> tells the browser to find the first element that matches your passed selection. Since you highlighted the text it will give you the most unique possible selection, so the first choice should be the correct one<sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup>.</p>

<p>This however, <code>document.querySelector</code> gives you the full HTML element. So a paragraph would be</p>

<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Lorem ipsum dolor sit amet..<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>`
</code></pre></div>

<p>We don't need the <code>&lt;p&gt;&lt;/p&gt;</code> parts. Luckily we can use the <code>innerText</code> attribute. As <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/innerText">Mozilla</a> explains it:</p>

<blockquote>
  <p>The innerText property of the HTMLElement interface represents the "rendered" text content of a node and its descendants. As a getter, it approximates the text the user would get if they highlighted the contents of the element with the cursor and then copied it to the clipboard.</p>
</blockquote>

<p>To test this you can paste your code into the console of your browser (a tab in the developer console.) or you can set the action to display the results. When you have the right element you can pass that information as a variable to use later in your Keyboard Maestro workflow or you can save it to your clipboard to paste into another window. </p>

<p><img src="https://ik.imagekit.io/cxazzw3yew/Keyboard%20Maestro%20Get%20Text%20from%20Website/execute%20javascript-squashed.png" alt="Execute Javascript" /></p>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p>If you do need to get another version you can use <code>querySelectorAll(&lt;Your Element&gt;)</code> and choose the index that you're looking for.&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>
    </section>
  </article>

  <section class="my-4 border-t-2 border-gray-400">
    <div class="content p-2">
      <a href="/blog-0.html" class="subtitle is-5 text-link"
        >Back to Blogs...</a
      >
    </div>
  </section>
</div>

         
    </div>
    <footer class="object-bottom pin-b bg-gray-100 px-4 my-4">
  <div class="container  lg:flex md:mx-auto justify-around">
    <p> kjaymiller.com</p>
    <p>Website made with <a
                             href="https://render-engine.site">Render Engine</a> and <a href="https://tailwindcss.com">TailwindCSS</a>
    <div class="level">
      <p class="level-item">
         <a href="/blog.rss.xml"><span class="icon"><i class="fas fa-rss"></i></a>
      </p>
      <p class="level-item">
       <a href="https://micro.blog/kjaymiller" rel="me">
         <span class="icon"><i name="micro.blog" class="fab fa-microblog"></i>
       </a>
     </p>
      <p class="level-item">
       <a href="https://twitter.com/kjaymiller" rel="me">
         <span class="icon"><i class="fab fa-twitter"></i></span>
       </a>
     </p>
    </div>
  </div>
</footer>
  </body>

</html>