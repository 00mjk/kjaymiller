<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="/static/css/tailwind.css">
    <script src="https://kit.fontawesome.com/4ac674b58e.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/base.css">
    <link rel="stylesheet" type="text/css" href="/static/css/pygments.css">
    
  <link rel="stylesheet"  type="text/css" href="/static/css/blog.css">

    <title>
      
      Showing the Toothfairy Icon only when my Airpods Pro are Connected - Jay Miller
    </title>
  </head>
  <body class="flex flex-col h-full"> 
    <header
  class="
    bg-gradient-to-br
    from-purple-600
    to-indigo-800
    w-full
    flex
    xl:py-10
    py-3
    px-3
  "
>
  <div class="lg:mx-auto container">
    <div class="flex items-end">
      <h1 id="" class="title mx-3 text-2xl font-extrablack text-gray-200">
        <a class="hover:no-decorate" href="/">Jay Miller</a>
      </h1>
    </div>
    <div class="md:flex hidden" id="site-menu">
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/about.html"
        >
          About
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/blog-0.html"
        >
          Blog
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="https://www.youtube.com/channel/UCjoJU65IbXkKXsNqydro05Q"
        >
          YouTube
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/conference-talks.html"
        >
          Talks
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/podcasts.html"
        >
          Podcasts
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/projects.html"
        >
          Projects
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/subscribe"
        >
          Newsletter
        </a>
      </div>
      
      <div class="p-3">
        <a
          class="
            rounded
            p-1
            hover:bg-gray-200
            hover:text-gray-600
            text-gray-200
          "
          href="/contact"
        >
          Contact
        </a>
      </div>
      
    </div>
    <div class="hidden">
      <form role="search" action="https://search.kjaymiller.com/">
        <div class="md:flex hidden">
          <input
            type="text"
            style="
              padding-left: 3em;
              background: url('/static/files/search.svg') 7px 0px white
                no-repeat;
            "
            class="inline border border-blue-800 rounded-full"
            name="q"
            id="search-bar"
            placeholder="Search"
          />
        </div>
      </form>
    </div>
  </div>
</header>
    <div class="m-4 xl:mx-auto container flex-grow">
         
<div class="container mx-auto m-4">
    <article>
            <div class="m-3">
                <h1 class="title text-4xl font-bold">Showing the Toothfairy Icon only when my Airpods Pro are Connected</h1>
              <small class="column is-narrow">
              Feb 15, 2021 16:43 PM
              </small>

        </div>
              <section class="bg-gray-400 flex">
                  <div class="px-3">
                  
                    <p class="">
                    <strong>Tags: </strong>
                    
                    <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="shell-0"
    class="">shell
   </a> 
</small >
                    
                    <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="apps-0"
    class="">apps
   </a> 
</small >
                    
                    <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="macos-0"
    class="">macos
   </a> 
</small >
                    
                    <small class="mx-2 p-1 rounded border border-gray-400 bg-gray-200">
   <a href="automation-0"
    class="">automation
   </a> 
</small >
                    
                    </p>
                    
                </div>
              </section>
        </section>
        <hr />

        

        
        
        
	<img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/ToothFairy%20Toggle.png">
    <section class="section my-4 py-4">
          <div class="content">
            <p>Recently <a href="https://macbartender.com">Bartender 4</a> released with a couple of features that I was super stoked about. </p>

<p>One of those updates was the ability to add custom rules for showing/hiding icons based. Wanting to play with this more I created a watcher shell script for showing/hiding the <a href="https://c-command.com/toothfairy/">ToothFairy</a> icon.</p>

<p><img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/ToothFairy%20Toggle.png" alt="Bartender Showing Toothfairy" /></p>

<p>The end result of this script is that when my Airpods Pro are connected to the device, the toothfairy icon will appear in the menu bar. Once the Airpods Pro are disconnected the icon will go back to being hidden. This means that I can quickly tell when my AirPods Pro are connected to my machine (even if they are also connected to my phone or iPad).</p>

<p><img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/bartender-toothfairy-disabled.png" alt="Airpods are not connected and the icon is in the secondary Bartender Bar" /></p>

<h2>The Script</h2>

<p>I found the command for getting your Bluetooth settings just tabbing through terminal commands. </p>

<p><code>AP_STAT=$(system_profiler SPBluetoothDataType | grep -A9 "Jay’s AirPods Pro:")</code></p>

<p>This saves the information for any bluetooth device named <em>Jay's AirPods Pro</em> to <code>AP_STAT</code> (Airpods Status).</p>

<p>I got help from this similar idea from <a href="https://github.com/godbout/alfred-airpodspro-battery">Godbout's Alfred Workflow</a>. </p>

<p><code>echo $AP_STAT | awk '/Connected: Yes/{print 1}'</code></p>

<p>echo prints the data and awk is a <em>text manipulation</em> command. It looks for the pattern <code>Connnected: Yes</code> and returns a 1 if it is found (otherwise it returns nothing).</p>

<p>Bartender looks for a <em>True</em> value which <code>1</code> is. </p>

<p><img src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/toothfairy-bartender-enabled.png" alt="Airpods are Enabled and the icon is showing in the main menubar" /></p>

<p>Here's the whole script</p>

<pre><code>AP_STAT=$(system_profiler SPBluetoothDataType | grep -A9 "Jay’s AirPods Pro:")
echo $AP_STAT | awk '/Connected: Yes/{print 1}'
</code></pre>

<p>Both <a href="https://c-command.com/toothfairy/">ToothFairy</a> and <a href="https://macbartender.com">Bartender 4</a> (available on Big Sur ONLY) are both a part of <a href="https://go.setapp.com/invite/6bcd77a8-3223-482b-bcd2-ff337999765d">SetApp (Affiliate Link)</a></p>
 
          </div>
        </section>
      </article>
    <section class="my-4 border-t-2 border-gray-400">
      <div class="content p-2">
      <a href="/blog-0.html" class="subtitle is-5 text-link">Back to
        Blogs...</a>
    </section>
</div>

         
    </div>
    <footer class="object-bottom pin-b bg-gray-100 px-4 my-4">
  <div class="container  lg:flex md:mx-auto justify-around">
    <p> kjaymiller.com</p>
    <p>Website made with <a
                            href="https://github.com/kjaymiller/render_engine">Render Engine</a> and <a href="https://tailwindcss.com">TailwindCSS</a>
    <div>
      <p>
         <a href="/blog.rss.xml"><span class="icon"><i class="fas fa-rss"></i></a>
      </p>
    </div>
  </div>
  <div class="m-auto w-3/4 grid grid-cols-4 p-3">
    <figure class="social youtube">
        <a href="https://www.youtube.com/channel/UCjoJU65IbXkKXsNqydro05Q/">
            <img class="rounded-full" src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/YouTube_icon_square_logo.jpg?tr=w-50" alt="YouTube">
        </a>
    </figure>
    <figure class="social twitter">
        <a href="https://twitter.com/kjaymiller">
            <img class="rounded-full" src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/Twitter_icon_square_logo.jpg?tr=w-50 alt="Twitter">
        </a>
    </figure>
    <figure class="social linkedin">
        <a href="https://linkedin.com/in/kjaymiller">
            <img class="rounded-full" src="https://kjaymiller.s3-us-west-2.amazonaws.com/images/LinkedIn_icon_square_logo.jpg?tr=w-50" alt="LinkedIn">
        </a>
    </figure>
</div>
</footer>
  </body>

</html>